---
interface Props {
	name: string;
}

const { name } = Astro.props;
const signatureLetters = name.split('');
---

<span class="name handwriting fade-seq-2">
	<span class="signature-wrapper" aria-hidden="true">
		{signatureLetters.map((char, index) => (
			<span class="signature-letter" style={`--letter-index:${index};`} data-char={char}>
				{char === ' ' ? '\u00A0' : char}
			</span>
		))}
	</span>
	<span class="signature-fallback" aria-label={name}>{name}</span>
</span>

<style>
	@import url('https://fonts.googleapis.com/css2?family=Pacifico&display=swap');

	.name {
		font-size: 4.5rem;
		font-weight: 600;
		color: #1a1a1a;
		letter-spacing: 0.02em;
		line-height: 1.2;
	}

	.handwriting {
		position: relative;
		display: inline-flex;
		align-items: center;
		font-style: italic;
	}

	.signature-wrapper {
		display: inline-flex;
		gap: 0.1em;
	}

	.signature-letter {
		position: relative;
		display: inline-flex;
		font-family: 'Pacifico', 'Hiragino Sans GB', cursive;
		font-size: clamp(2.5rem, 6vw, 4.5rem);
		font-style: italic;
		color: #1a1a1a;
		transform-origin: left center;
		transform: scaleX(0);
		opacity: 0;
	}

	.signature-letter[data-char="_"] {
		letter-spacing: 0.25em;
	}

	.signature-fallback {
		position: absolute;
		left: 50%;
		transform: translateX(-50%);
		font-family: 'Pacifico', 'Hiragino Sans GB', cursive;
		font-size: clamp(2.5rem, 6vw, 4.5rem);
		font-style: italic;
		opacity: 0;
		pointer-events: none;
	}

	.signature-letter::after {
		content: '';
		position: absolute;
		right: -4px;
		top: 50%;
		width: 6px;
		height: 6px;
		background: #1a1a1a;
		border-radius: 50%;
		transform: translate(0, -50%) scale(0);
		opacity: 0;
	}

	:global(.page-ready) .signature-letter {
		animation: letterReveal 0.4s ease forwards;
		animation-delay: calc(0.6s + var(--letter-index) * 0.18s);
	}

	:global(.page-ready) .signature-letter::after {
		animation: penTrail 0.35s ease forwards;
		animation-delay: calc(0.6s + var(--letter-index) * 0.18s);
	}

	@keyframes letterReveal {
		from {
			transform: scaleX(0);
			opacity: 0.2;
		}
		to {
			transform: scaleX(1);
			opacity: 1;
		}
	}

	@keyframes penTrail {
		0% {
			transform: translate(0, -50%) scale(0);
			opacity: 0;
		}
		30% {
			transform: translate(0, -50%) scale(1);
			opacity: 1;
		}
		100% {
			transform: translate(12px, -50%) scale(0);
			opacity: 0;
		}
	}

	@media (max-width: 768px) {
		.name {
			font-size: 3rem;
		}

		.signature-wrapper {
			width: 100%;
		}
	}

	@media (max-width: 480px) {
		.name {
			font-size: 2.5rem;
		}
	}
</style>

